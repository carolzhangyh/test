X <- cbind(rep(1,200),x1,x2)
X
sigma2=1
round(vcov(fit),5)
round(sigma2*solve(t(X) %*% X),5)
summary(fit)
round(vcov(fit),5)
X <- cbind(rep(1,200),x1,x2)
X
sigma2=1
round(vcov(fit),5)
round(sigma2*solve(t(X) %*% X),5)
summary(fit)
round(vcov(fit),5)
X <- cbind(rep(1,200),x1,x2)
X
sigma2=1
round(vcov(fit),5)
round(sigma2*solve(t(X) %*% X),5)
summary(fit)
round(vcov(fit),5)
X <- cbind(rep(1,200),x1,x2)
X
sigma2=1
round(vcov(fit),5)
round(sigma2*solve(t(X) %*% X),5)
summary(fit)
summary(fit)$coef[2,4] < 0.05
anova(fit)
rejectH0 <- NULL
for (i in 1:1000){
x1 <- rnorm(n=200,mean=0,sd=2)
x2 <- rnorm(n=200,mean=0,sd=2)
e <- rnorm(n=200,mean=0,sd=1)
y <- 1+2*x1+5*x2+ e
fit <- lm(y~x1+x2)
rejectH0[i] = summary(fit)$coef[2,4]<0.05
}
if (rejectH0=TRUE){
x=2;}
rejectH0
mean(rejectH0)
hist(x,main="proportion of times reject H0", xlab="reject H0", ylab= "frequency", col=3)
rejectH0 <- NULL
for (i in 1:1000){
x_1 <- rnorm(n=200,mean=0,sd=2)
x_2 <- rnorm(n=200,mean=0,sd=2)
e <- rnorm(n=200,mean=0,sd=1)
y <- 1+2*x1+5*x2+ e
fit <- lm(y~x1+x2)
rejectH0[i] = summary(fit)$coef[2,4]<0.05
}
if (rejectH0=TRUE){
x=2;}
rejectH0
mean(rejectH0)
hist(x,main="proportion of times reject H0", xlab="reject H0", ylab= "frequency", col=3)
x = 2;}
rejectH0
mean(rejectH0)
hist(x,main="proportion of times reject H0", xlab="reject H0", ylab= "frequency", col=3)
rejectH0 <- NULL
for (i in 1:1000){
x_1 <- rnorm(n=200,mean=0,sd=2)
x_2 <- rnorm(n=200,mean=0,sd=2)
e <- rnorm(n=200,mean=0,sd=1)
y <- 1+2*x1+5*x2+ e
fit <- lm(y~x1+x2)
rejectH0[i] = summary(fit)$coef[2,4]<0.05
}
if (rejectH0 = TRUE){
x = 2;}
rejectH0
mean(rejectH0)
hist(x,main="proportion of times reject H0", xlab="reject H0", ylab= "frequency", col=3)
if (rejectH0 = TRUE){
x = 2;}
rejectH0
if (rejectH0 = TRUE){
x = 2;}
rejectH0
mean(rejectH0)
hist(x,main="proportion of times reject H0", xlab="reject H0", ylab= "frequency", col=3)
rejectH0 <- NULL
for (i in 1:1000){
x_1 <- rnorm(n=200,mean=0,sd=2)
x_2 <- rnorm(n=200,mean=0,sd=2)
e <- rnorm(n=200,mean=0,sd=1)
y <- 1+2*x1+5*x2+ e
fit <- lm(y~x1+x2)
rejectH0[i] = summary(fit)$coef[2,4]<0.05
}
rejectH0
mean(rejectH0)
hist(x,main="proportion of times reject H0", xlab="reject H0", ylab= "frequency", col=3)
rejectH0 <- NULL
for (i in 1:1000){
x_1 <- rnorm(n=200,mean=0,sd=2)
x_2 <- rnorm(n=200,mean=0,sd=2)
e <- rnorm(n=200,mean=0,sd=1)
y <- 1+2*x1+5*x2+ e
fit <- lm(y~x1+x2)
rejectH0[i] = summary(fit)$coef[2,4]<0.05
}
rejectH0
mean(rejectH0)
mean(rejectH0)
sd(rejectH0)
rejectH0 <- NULL
for (i in 1:1000){
x_1 <- rnorm(n=200,mean=0,sd=2)
x_2 <- rnorm(n=200,mean=0,sd=2)
e <- rnorm(n=200,mean=0,sd=1)
y <- 1+2*x1+5*x2+ e
fit <- lm(y~x1+x2)
rejectH0[i] = summary(fit)$coef[2,4]<0.05
}
rejectH0
mean(rejectH0)
sd(rejectH0)
library(readxl)
gamble <- read_excel("C:/Users/carol/Desktop/stat350/gamble.csv")
View(gamble)
mydata <- read.csv("geyser.csv",header=TRUE)
mydata <- read.csv("geyser.csv",header=TRUE)
mydata <- read.csv("geyser.csv",header=TRUE)
mydata
mydata <- read.csv("geyser.csv",header=TRUE)
mydata
mydata <- read.csv("geyser.csv",header=TRUE)
mydata
mydata <- read.csv("gamble.csv",header=TRUE)
mydata
mydata <- read.csv("gamble.csv",header=TRUE)
mydata
#1st example
data("cars")
plot(cars)
abline(lm(cars[,2]~cars[,1]))
mydata <- read.csv("gamble.csv",header=TRUE)
mydata
mydata <- read.csv("gamble",header=TRUE)
mydata
mydata <- read.csv("gamble",header=TRUE)
mydata <- read.csv("gamble",header=TRUE)
mydata <- read.csv("gamble.csv",header=TRUE)
mydata
mydata <- read.csv("gamble.csv",header=TRUE)
mydata <- read.csv("gamble.csv",header=TRUE)
mydata <- read.csv("geyser.csv",header=TRUE)
mydata
mydata <- read.csv("geyser.csv",header=TRUE)
getwd()
seted("c:/Users/carol/Desktop")
setwd("c:/Users/carol/Desktop")
mydata <- read.csv("geyser.csv",header=TRUE)
mydata <- read.csv("geyser.csv",header=FALSE)
mydata <- read.csv("geyser.csv",header=FALSE)
mydata
mydata <- read.csv("gamble.csv",header=TRUE)
mydata
getwd()
setwd("c:/Users/carol/Desktop")
getwd()
setwd("c:/Users/carol/Desktop")
mydata <- read.csv("gamble.csv",header=TRUE)
setwd("C:/Users/carol/Desktop/stat350")
data <- read.csv("C:/Users/carol/Desktop/stat350")
mydata <- read.csv("data_computer_experiment.csv",header=TRUE)
mydata
head(data)
data <- read.csv("C:/Users/carol/Desktop/stat350")
data <- read.csv("data_computer_experiment.csv",header=TRUE)
setwd("C:/Users/carol/Desktop/stat350")
data <- read.csv("data_computer_experiment.csv",header=TRUE)
data
head(data)
residtable<-cbind(resid(fit2), rstandard(fit2), rstudent(fit2))
setwd("C:/Users/carol/Desktop/stat350")
data <- read.csv("data_computer_experiment.csv",header=TRUE)
data
head(data)
fit2  <- lm(location~. , data = data)
round(vcov(fit2),4)
vcov(fit2)[2,2]
vcov(fit2)[2,6]
summary(fit2)
resid(fit2)
rstandard(fit2)
rstudent(fit2)
plot(fit2,which=1) #i)constant variance non-linear iv)outlier
plot(fit2,which=2) #ii)The distribution is normal in general but some extrem outliers
plot(fit2,which=5) #v)no influential observation cooks distance is small smaller than 0.5
#iii)no leverage points
plot(fit2,which=4) #small cooks distance
residtable<-cbind(resid(fit2), rstandard(fit2), rstudent(fit2))
summary(residtable)
summary(fit2)
resid(fit2)
rstandard(fit2)
rstudent(fit2)
plot(fit2,which=1) #i)constant variance non-linear iv)outlier
plot(fit2,which=2) #ii)The distribution is normal in general but some extrem outliers
plot(fit2,which=5) #v)no influential observation cooks distance is small smaller than 0.5
#iii)no leverage points
plot(fit2,which=4) #small cooks distance
plot(data$energy,resid(fit2))
plot(data$thickness,resid(fit2))
plot(data$flux,resid(fit2))
plot(data$gamma,resid(fit2))
plot(data$opacity,resid(fit2))
plot(data$energy,resid(fit2))
plot(data$thickness,resid(fit2))
plot(data$flux,resid(fit2))
plot(data$gamma,resid(fit2))
plot(data$opacity,resid(fit2))
residtable<-cbind(resid(fit2), rstandard(fit2), rstudent(fit2))
summary(residtable)
# Partial Plots
# y, given x2
mod1 <- lm(location ~. -thickness,data=data )
resid.1 <- resid(mod1)
# x1, given x2
mod2 <- lm(thickness ~. -location, data=data)
resid.2 <- resid(mod2)
plot(resid.2, resid.1, main='thickness added plot')
mod1 <- lm(location ~. -flux,data=data )
resid.1 <- resid(mod1)
# x1, given x2
mod2 <- lm(flux ~. -location, data=data)
resid.2 <- resid(mod2)
plot(resid.2, resid.1, main='flux added plot')
plot(data$energy,resid(fit2))
plot(data$thickness,resid(fit2))
plot(data$flux,resid(fit2))
plot(data$gamma,resid(fit2))
plot(data$opacity,resid(fit2))
plot(data$energy,resid(fit2))
plot(data$thickness,resid(fit2))
plot(data$flux,resid(fit2))
plot(data$energy,resid(fit2))
plot(data$thickness,resid(fit2))
plot(data$flux,resid(fit2))
plot(data$gamma,resid(fit2))
plot(data$opacity,resid(fit2))
residtable<-cbind(resid(fit2), rstandard(fit2), rstudent(fit2))
summary(residtable)
setwd("C:/Users/carol/Desktop/stat350")
data <- read.csv("data_computer_experiment.csv",header=TRUE)
data
mod1 <- lm(location ~. -flux,data=data )
resid.1 <- resid(mod1)
mod1 <- lm(location ~. -flux,data=data )
resid.1 <- resid(mod1)
# x1, given x2
mod2 <- lm(flux ~. -location, data=data)
resid.2 <- resid(mod2)
plot(resid.2, resid.1, main='flux added plot')
plot(resid.2, resid.1, main=' plot with flux', col=3)
# Partial Plots
# y, given x2
mod1 <- lm(location ~. -thickness,data=data )
resid.1 <- resid(mod1)
# x1, given x2
mod2 <- lm(thickness ~. -location, data=data)
resid.2 <- resid(mod2)
plot(resid.2, resid.1, main='thickness added plot')
mod1 <- lm(location ~. -flux,data=data )
resid.1 <- resid(mod1)
# x1, given x2
mod2 <- lm(flux ~. -location, data=data)
resid.2 <- resid(mod2)
plot(resid.2, resid.1, main=' plot with flux', col=3)
# Partial Plots
# y, given x2
mod1 <- lm(location ~. -thickness,data=data )
resid.1 <- resid(mod1)
# x1, given x2
mod2 <- lm(thickness ~. -location, data=data)
resid.2 <- resid(mod2)
plot(resid.2, resid.1, main='thickness added plot')
mod1 <- lm(location ~. -flux,data=data )
resid.1 <- resid(mod1)
resid1 <-resid(mod1)
resid1 <-resid(mod1)
resid1
plot(resid1)
install.packages("MPV")
install.packages("faraway")
library(MPV)
library(faraway)
residtable<-cbind(resid(mod1),
rstandard(mod1), rstudent(mod1))
residtable
plot(residtable)
vif(redwine)
white_url <- "https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv"
redwine <- read.csv(white_url, header = TRUE, sep = ";")
redwine
vif(redwine)
vif(sulphates * alcohol)
plot(redwine,rstudent(redwine),main="residual plot", ylab="studentaized residual")
library(car)
plot(redwine,rstudent(redwine),main="residual plot", ylab="studentaized residual")
install.packages("car")
install.packages("car")
library(car)
plot(redwine,rstudent(redwine),main="residual plot", ylab="studentaized residual")
rstudent(redwine)
df3 = read.csv("guinea_pig.csv")[,-1]
tail(df3)
pairs(df3)
fit3 = lm(y~., data=df3)
summary(fit3)
plot(fit3, 1)
plot(fitted(fit3),rstudent(fit3),main="residual plot", ylab="studentaized residual")
abline(h=0)
plot(fit3, 1)
plot(fitted(fit3),rstudent(fit3),main="residual plot", ylab="studentaized residual")
plot(fit3, 1)
plot(fitted(fit3),rstudent(fit3),main="residual plot", ylab="studentaized residual")
plot(fit3, 1)
plot(mod_4, 1)
plot(mod4, 1)
plot(mod4.5, 1)
plot(mod0, 1)
mod4.5 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity.alcohol, data=redwine)
#####################cross validation###################
white_url <- "https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv"
redwine <- read.csv(white_url, header = TRUE, sep = ";")
redwine
mod1 <- lm(quality ~volatile.acidity +chlorides +total.sulfur.dioxide +sulphates +alcohol, data=redwine)
mod2 <- lm(quality~ fixed.acidity +volatile.acidity +citric.acid + log10_rs +log10_chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +density +pH +log10_sulphates +alcohol, data=redwine)
mod4.5 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity.alcohol, data=redwine)
ANOVA(MODEL)
plot(mod4.5, 1)
mod4.5 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity.alcohol, data=redwine)
mod4.5 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity*alcohol, data=redwine)
plot(mod4.5, 1)
plot(redwine,rstudent(mod4.5),main="residual plot", ylab="studentaized residual")
plot(redwine,rstudent(mod4.5),main="residual plot")
rstudent(mod4.5)
plot(mod4.5, 1)
plot(rstudent(mod4.5))
plot(redwine,rstudent(mod4.5),main="residual plot")
hist(rstudent(mod4.5))
mod2 <- lm(quality~ fixed.acidity +volatile.acidity +citric.acid + log10_rs +log10_chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +density +pH +log10_sulphates +alcohol, data=redwine)
##4 - residual sugar log!!
quality <- (redwine$quality)
log10_rs <- log10(redwine$residual.sugar)
rs <- redwine$residual.sugar
cor(quality, redwine$rs)  ##0.0137
cor(quality, log10_rs) ##0.0235
##5 - chlorides log!!
log10_chlorides <- log10(redwine$chlorides)
##4 - residual sugar log!!
quality <- (redwine$quality)
log10_rs <- log10(redwine$residual.sugar)
##5 - chlorides log!!
log10_chlorides <- log10(redwine$chlorides)
cor(quality, redwine$chlorides)  ##-0.129
##10 - sulphates log!!
log10_sulphates <- log10(redwine$sulphates)
cor(quality, redwine$sulphates)  ##0.251
#linear regression model for data transformation
mod2 <- lm(quality~ fixed.acidity +volatile.acidity +citric.acid + log10_rs +log10_chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +density +pH +log10_sulphates +alcohol, data=redwine)
hist(rstudent(mod2))
install.packages("rstudent")
library(rstudent)
############validation##########
n=nrow(redwine)
set.seed(666)
nsamp=ceiling(0.7*n)
training_samps=sample(1:n,nsamp)
train_data<-redwine[training_samps,]
test_data<-redwine[-training_samps,]
train_data
test_data
fit<-lm(quality ~ .-fixed.acidity-citric.acid-residual.sugar-free.sulfur.dioxide-density-pH-alcohol, data=train_data)
y_hat <- predict(fit, newdata=test_data)
r_2=cor(y_hat,test_data$quality)^2
r_2
###summary
install.packages("MASS")
library(MASS)
set.seed(666)
index= sample.int(1050, size=1050, replace=TRUE)
slopeFULL <- rlm(quality ~., psi=psi.huber,data=redwine[index,])$coef
slope1 <- rlm(quality ~volatile.acidity +chlorides +total.sulfur.dioxide +sulphates +alcohol, psi=psi.huber,data=redwine[index,])$coef
slope2.5 <- rlm(quality ~fixed.acidity +volatile.acidity +citric.acid + residual.sugar +chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +density +pH +sulphates +alcohol, psi=psi.huber,data=redwine[index,])$coef
slope3.5 <- rlm(quality ~volatile.acidity +chlorides +total.sulfur.dioxide +sulphates, psi=psi.huber,data=redwine[index,])$coef
slope4.5 <- rlm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+alcohol*volatile.acidity, psi=psi.huber,data=redwine[index,])$coef
slopeFULL
slope1
slope2.5
slope3.5
slope4.5
residtable<-cbind(resid(mod1),
rstandard(mod1), rstudent(mod1))
plot(residtable)
resid1 <-resid(mod1)
plot(resid1)
resid2 <-resid(mod2)
plot(resid2)
resid1 <-resid(mod4)
resid1 <-resid(mod1)
plot(resid1)
resid2 <-resid(mod2)
plot(resid2)
resid3 <-resid(mod3)
plot(resid3)
resid4 <-resid(mod4)
plot(resid4)
resid5 <-resid(mod5)
plot(resid5)
resid0 <-resid(mod0)
plot(resid0)
mod2 <- lm(quality~ fixed.acidity +volatile.acidity +citric.acid + log10_rs +log10_chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +density +pH +log10_sulphates +alcohol, data=redwine)
resid2 <-resid(mod2)
plot(resid2)
resid0 <-resid(mod0)
plot(resid0)
mod0<-lm(quality ~ ., data=train_data)
resid0 <-resid(mod0)
plot(resid0)
resid1 <-resid(mod1)
plot(resid1)
resid3 <-resid(mod3)
mod3 <- lm(quality~volatile.acidity +log10_chlorides +total.sulfur.dioxide +log10_sulphates, data=redwine)
resid3 <-resid(mod3)
plot(resid3)
mod4 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity*alcohol, data=redwine)
mod4.5 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity*alcohol, data=redwine)
resid4 <-resid(mod4)
plot(resid4)
resid0 <-resid(mod0)
plot(resid0)
resid1 <-resid(mod1)''
'plot(resid1)
resid2 <-resid(mod2)
plot(resid2)
resid3 <-resid(mod3)
plot(resid3)
resid4 <-resid(mod4)
plot(resid4)
resid5 <-resid(mod5)
plot(resid5)
resid1 <-resid(mod1)
plot(resid1)
resid1 <-resid(mod1)
plot(resid1)
resid3 <-resid(mod3)
plot(resid3)
resid1 <-resid(mod1)
plot(resid1)
resid0 <-resid(mod0)
plot(resid0)
resid1 <-resid(mod1)
plot(resid1)
resid2 <-resid(mod2)
plot(resid2)
resid3 <-resid(mod3)
plot(resid3)
resid4 <-resid(mod4)
plot(resid4)
resid5 <-resid(mod5)
plot(resid5)
resid3 <-resid(mod3)
plot(resid3)
mod4 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity*alcohol, data=redwine)
mod4.5 <- lm(quality~ fixed.acidity + volatile.acidity +citric.acid +residual.sugar+chlorides
+free.sulfur.dioxide +total.sulfur.dioxide +pH+density +sulphates +alcohol
+volatile.acidity * total.sulfur.dioxide +sulphates*alcohol+volatile.acidity*alcohol, data=redwine)
###rstudent plot
install.packages("car")
library(car)
plot(redwine,rstudent(mod4.5),main="residual plot")
hist(rstudent(mod4.5))
hist(rstudent(mod4))
resid0 <-resid(mod0)
plot(resid0)
resid1 <-resid(mod1)
plot(resid1)
resid2 <-resid(mod2)
plot(resid2)
resid3 <-resid(mod3)
plot(resid3)
resid4 <-resid(mod4)
plot(resid4)
resid5 <-resid(mod5)
plot(resid5)
